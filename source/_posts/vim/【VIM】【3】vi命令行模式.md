---
title: 【VIM】【3】vi命令行模式
date: 2023-10-09 21:12:27
categories:
  - 【Coder, Vim】
tags:
  - Vim
---

## 命令行模式 (command-line mode)

保存、退出、查找、替换等命令

<hr>
<br>

### 如何进入

在一般命令模式中，输入【:/?】三个中的任何一个字符，就可进入命令行模式

<hr>
<br>

### 按键说明

- 保存或退出
- 查找替换
- vi环境修改

【!】在vi中，常常具有"强制"的意思

<hr>
<br>

#### 保存或退出

|          按键           | 说明                                                                                 |
|:---------------------:|:-----------------------------------------------------------------------------------|
|         【:w】          | 保存，将编辑的数据写入硬盘文件中 （常用）                                                              |
|         【:w!】         | 若文件属性为【只读】时，强制写入该文件。不过能不能写入，还是跟你对该文件的文件权限有关                                        |
|         【:q】          | 退出vi （常用）                                                                          |
|         【:q!】         | 若曾修改过文件，又不想保存，使用【!】为强制退出，不保存                                                       |
|         【:wq】         | 保存后退出 （常用）                                                                         |
|        【:wq!】         | 强制保存后退出                                                                            |
|         【ZZ】          | 若文件没有修改，则不保存退出<br/> 若文件修改过，则保存后退出                                                  |
|    【:w [filename]】    | 将编辑的数据保存成另一个文件 （类似另存新文件）                                                           |
|    【:r [filename]】    | 在编辑的数据中，读入另一个文件的数据，亦即将【filename】这个文件内容加到光标所在行后面                                    |
| 【:n1,n2 w [filename]】 | 将n1到n2的内容保存为【filename】这个文件                                                         |
|     【:! command】      | 暂时退出vi到命令行模式下执行【command】的显示结果<br/> 比如：【:! ls /home】即可在vi当中查看 【/home】下面以【ls】输出的文件信息 |

#### 查找与替换

##### 查找

|   按键   | 说明                    |
|:------:|:----------------------|
| 【/str】 | 从光标处，向下查找 str 字符 （常用） |
| 【?str】 | 从光标处，向上查找 str 字符      |

进行查找时，按 【n】 或 【N】 键，可重复上一个查找操作
【n】 向后查找，【N】 向前查找

##### 替换

|           按键            | 说明                                                            |
|:-----------------------:|:--------------------------------------------------------------|
| 【:n1,n2s/word1/word2/g】 | n1 和 n2 为数字，在第 n1 和 n2 行之间，寻找 word1 字符串，并将其替换为 word2 字符串 （常用） |
|  【:1,$s/word1/word2/g】  | 在第一次到最后一行之间，寻找 word1 字符串，并将其替换为 word2 字符串                     |
| 【:1,$s/word1/word2/gc】  | 在第一次到最后一行之间，寻找 word1 字符串，并将其替换为 word2 字符串，每次替换进行确认            |

上述操作举例
从第10行到第100行，将 python 替换成 java 的命令如下：
":10,100s/python/java/g"



#### vi环境修改

|     按键      | 说明                       |
|:-----------:|:-------------------------|
|  【:set nu】  | 显示行号，设置后，会在每一行的前缀显示改行的行号 |
| 【:set nonu】 | 与【:set nu】相反，为取消行号       |

